import{_ as K}from"./layout.218b83be.js";import{a as Q,y as w,C as W,r as x,c as X,w as N,l as J,o as c,u as i,k as p,e,H as _,f as m,h as Z,z as g,q as u,v as f,J as T,F as I,D,A as O,E as d,p as ee,b as te}from"./entry.901372f0.js";import{u as se}from"./dayjs.a7802b3f.js";import{_ as ae}from"./edit.9f57023c.js";import{_ as ie}from"./delete.29df2ba8.js";import{g as le,a as ne,e as $}from"./task.01ab21d8.js";import{g as oe}from"./script.3a86267e.js";const o=S=>(ee("data-v-b308f35e"),S=S(),te(),S),de={key:0,class:"manage"},re=o(()=>e("div",{class:"manage-between"},[e("div",{class:"manage-head"},"我的任務"),e("div",{class:"manage-row"})],-1)),ce={class:"manage-center"},pe=o(()=>e("div",null,"尚無任何任務",-1)),ue={key:1,class:"manage"},me={class:"manage-between"},ve=o(()=>e("div",{class:"manage-head"},"我的任務",-1)),_e={class:"manage-row"},ge={class:"manage-num"},fe={class:"Mtable"},ye={class:"Mtable-row"},be={class:"Mtable-icon-outer"},ke=["onClick"],he={class:"Mtable-icon-outer"},we=["onClick"],xe={key:2,class:"popup"},Se=o(()=>e("div",{class:"title"},"建立新任務",-1)),Me=o(()=>e("div",{class:"item-title"},"*任務名稱",-1)),Ce=o(()=>e("div",{class:"item-title"},"*選擇劇本",-1)),Ne={class:"select-container"},Te=["value"],Ie=o(()=>e("div",{class:"item-title"},"*學習對象",-1)),De={class:"select-container"},Ye=["value"],Ve=o(()=>e("div",{class:"item-title"},"*預期參與人數/組數",-1)),Ue=o(()=>e("div",{class:"item-title"},"*結束日期",-1)),Oe={key:3,class:"popup"},He=o(()=>e("div",{class:"title"},"編輯任務",-1)),Je=o(()=>e("div",{class:"item-title"},"*任務名稱",-1)),$e=o(()=>e("div",{class:"item-title"},"*選擇劇本",-1)),Pe={class:"select-container"},Ee=["value"],Be=o(()=>e("div",{class:"item-title"},"*學習對象",-1)),Le={class:"select-container"},je=["value"],Ae=o(()=>e("div",{class:"item-title"},"*預期參與人數/組數",-1)),Fe=o(()=>e("div",{class:"item-title"},"*結束日期",-1)),qe={key:4,class:"popup"},ze=o(()=>e("div",{class:"title"},"刪除提醒",-1)),Re=o(()=>e("div",{class:"box-hint"},"帳號刪除後將無法復原，您確認要刪除？",-1)),Ge={class:"box-row"},Ke={__name:"myList",setup(S){const Y=w([]),v=w([]);async function P(){const{data:r}=await oe();let t=JSON.parse(JSON.stringify(r.value.data.list));t=t.filter(l=>l.status!==0),Y.length=0,Y.push(...t),v.length=0,Y.forEach(l=>{v.push({text:l.title,value:l.scriptId})}),console.log("我的劇本 all data",v)}P();const V=[{id:0,text:"小學 (低年級)"},{id:1,text:"小學 (中年級)"},{id:2,text:"小學 (高年級)"},{id:3,text:"小學 (7年級)"},{id:4,text:"小學 (8年級)"},{id:5,text:"小學 (9年級)"}],E={0:"開啟任務",1:"進行中",2:"完成(包含結束)"},y=w([]);async function M(){const{data:r}=await le();let t=JSON.parse(JSON.stringify(r.value.data.list));t=t.filter(l=>l.status!==2),t.map(l=>{l.learningStr=V.filter(U=>U.id==l.learning)[0].text,l.statusStr=E[l.status],l.endTime=l.endTime.split(" ")[0]}),y.length=0,y.push(...t),console.log("我的任務 all data",y)}M();const B=r=>v.filter(t=>t.value==r)[0].text,L=W(),j=x(!1),b=x(!1),k=x(!1),h=x(!1);x({});const a=w({}),C=se(),n=w({author:"string",createTime:C().format("YYYY-MM-DD HH:mm:ss"),description:"string",endTime:"",estimatedParticipants:0,learning:0,memberId:0,priority:0,scriptId:0,status:0,taskName:"",taskId:0});async function A(){console.log("addData",n),n.taskName===""?d({message:"請輸入任務名稱！",type:"warning"}):n.scriptId===""?d({message:"請選擇劇本！",type:"warning"}):n.learning===""?d({message:"請選擇學習對象！",type:"warning"}):n.estimatedParticipants===""?d({message:"請輸入預期參與人數/組數！",type:"warning"}):n.endTime===""?d({message:"請輸入結束日期！",type:"warning"}):(n.endTime=C(n.endTime).format("YYYY-MM-DD HH:mm:ss"),await ne(n).catch(()=>{d.error("更新失敗")}).then(r=>{d({message:"更新成功",type:"success"}),b.value=!1,M()}))}function F(r){k.value=!0,Object.assign(a,JSON.parse(JSON.stringify(r)))}async function q(){k.value=!1,delete a.learningStr,delete a.statusStr,a.endTime=C(a.endTime).format("YYYY-MM-DD HH:mm:ss"),console.log("current",a),a.taskName===""?d({message:"請輸入任務名稱！",type:"warning"}):a.scriptId===""?d({message:"請選擇劇本！",type:"warning"}):a.learning===""?(console.log("current",a.learning),d({message:"請選擇學習對象！",type:"warning"})):a.estimatedParticipants===""?d({message:"請輸入預期參與人數/組數！",type:"warning"}):a.endTime===""?d({message:"請輸入結束日期！",type:"warning"}):await $(a.taskId,a).then(r=>{d({message:"更新成功",type:"success"}),M()}).catch(()=>{d.error("更新失敗")})}function z(r){k.value=!1,h.value=!0,Object.assign(a,JSON.parse(JSON.stringify(r)))}async function R(){h.value=!1,a.endTime=C(a.endTime).format("YYYY-MM-DD HH:mm:ss"),a.status=2,await $(a.taskId,a).then(r=>{d({message:"刪除成功",type:"success"}),M()}).catch(()=>{d.error("刪除失敗")})}return(r,t)=>{const l=J("el-table-column"),U=J("el-table"),G=K;return c(),X(G,{name:"custom"},{default:N(()=>[i(j)?(c(),p("div",de,[re,e("div",ce,[pe,e("div",{onClick:t[0]||(t[0]=s=>b.value=!0),class:"manage-center-add"},"+ 建立新任務")])])):(c(),p("div",ue,[e("div",me,[ve,e("div",_e,[e("div",ge,"項目數量："+_(i(y).length),1),e("div",{onClick:t[1]||(t[1]=s=>b.value=!0),class:"manage-create"},"+ 建立新任務")])]),e("div",fe,[m(U,{data:i(y),style:{width:"100%"}},{default:N(()=>[m(l,{prop:"taskName",label:"任務名稱",sortable:"","min-width":"160"}),m(l,{prop:"script",label:"劇本",sortable:"","min-width":"160"},{default:N(s=>[Z(_(B(s.row.scriptId)),1)]),_:1}),m(l,{prop:"learningStr",label:"學習對象",sortable:"","min-width":"160"}),m(l,{prop:"statusStr",label:"任務狀態",sortable:"","min-width":"160"}),m(l,{prop:"endTime",label:"結束時間",sortable:"","min-width":"160"}),m(l,{prop:"createTime",label:"建立時間",sortable:"","min-width":"160"}),m(l,{label:"操作",sortable:"","min-width":"260"},{default:N(s=>[e("div",ye,[e("div",{onClick:t[2]||(t[2]=g(H=>i(L).push({path:"/mission/myMission"}),["stop"])),class:"Mtable-look"},"查看 -> "),e("div",be,[e("img",{onClick:g(H=>F(s.row),["stop"]),class:"Mtable-icon",src:ae,alt:"close"},null,8,ke)]),e("div",he,[e("img",{onClick:g(H=>z(s.row),["stop"]),class:"Mtable-icon",src:ie,alt:"close"},null,8,we)])])]),_:1})]),_:1},8,["data"])])])),i(b)?(c(),p("div",xe,[e("div",{onClick:t[9]||(t[9]=s=>b.value=!1),class:"box"},[e("div",{onClick:t[8]||(t[8]=g(()=>{},["stop"])),class:"block-box"},[Se,Me,e("div",null,[u(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>i(n).taskName=s),class:"input",placeholder:"請輸入文字",type:"text"},null,512),[[f,i(n).taskName]])]),Ce,e("div",Ne,[u(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>i(n).scriptId=s),class:"select"},[(c(!0),p(I,null,D(i(v),s=>(c(),p("option",{value:s.value,key:s.value},_(s.text),9,Te))),128))],512),[[T,i(n).scriptId]])]),Ie,e("div",De,[u(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>i(n).learning=s),class:"select"},[(c(),p(I,null,D(V,s=>e("option",{value:s.id,key:s.id},_(s.text),9,Ye)),64))],512),[[T,i(n).learning]])]),Ve,e("div",null,[u(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>i(n).estimatedParticipants=s),class:"input",min:0,placeholder:"請輸入數字",type:"number"},null,512),[[f,i(n).estimatedParticipants]])]),Ue,e("div",null,[u(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>i(n).endTime=s),class:"input",type:"date"},null,512),[[f,i(n).endTime]])]),e("div",{onClick:A,class:"btn-green"},"確認")])])])):O("",!0),i(k)?(c(),p("div",Oe,[e("div",{onClick:t[16]||(t[16]=s=>k.value=!1),class:"box"},[e("div",{onClick:t[15]||(t[15]=g(()=>{},["stop"])),class:"block-box"},[He,Je,e("div",null,[u(e("input",{"onUpdate:modelValue":t[10]||(t[10]=s=>i(a).taskName=s),class:"input",placeholder:"請輸入文字",type:"text"},null,512),[[f,i(a).taskName]])]),$e,e("div",Pe,[u(e("select",{"onUpdate:modelValue":t[11]||(t[11]=s=>i(a).scriptId=s),class:"select"},[(c(!0),p(I,null,D(i(v),s=>(c(),p("option",{value:s.value,key:s.value},_(s.text),9,Ee))),128))],512),[[T,i(a).scriptId]])]),Be,e("div",Le,[u(e("select",{"onUpdate:modelValue":t[12]||(t[12]=s=>i(a).learning=s),class:"select"},[(c(),p(I,null,D(V,s=>e("option",{value:s.id,key:s.id},_(s.text),9,je)),64))],512),[[T,i(a).learning]])]),Ae,e("div",null,[u(e("input",{"onUpdate:modelValue":t[13]||(t[13]=s=>i(a).estimatedParticipants=s),class:"input",placeholder:"請輸入數字",type:"number"},null,512),[[f,i(a).estimatedParticipants]])]),Fe,e("div",null,[u(e("input",{"onUpdate:modelValue":t[14]||(t[14]=s=>i(a).endTime=s),class:"input",type:"date"},null,512),[[f,i(a).endTime]])]),e("div",{onClick:q,class:"btn-green"},"確認")])])])):O("",!0),i(h)?(c(),p("div",qe,[e("div",{onClick:t[19]||(t[19]=s=>h.value=!1),class:"box"},[e("div",{onClick:t[18]||(t[18]=g(()=>{},["stop"])),class:"block-box"},[ze,Re,e("div",Ge,[e("div",{onClick:t[17]||(t[17]=s=>h.value=!1),class:"box-cancel"},"取消"),e("div",{onClick:R,class:"box-delete"},"刪除")])])])])):O("",!0)]),_:1})}}},at=Q(Ke,[["__scopeId","data-v-b308f35e"]]);export{at as default};
